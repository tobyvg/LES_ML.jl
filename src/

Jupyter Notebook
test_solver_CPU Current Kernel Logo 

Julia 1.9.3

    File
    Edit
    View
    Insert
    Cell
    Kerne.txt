

Jupyter Notebook
test_solver_CPU Current Kernel Logo 

Julia 1.9.3

    File
    Edit
    View
    Insert
    Cell
    Kernel
    Widgets
    Help

​

using Plots

using LES_ML

using LaTeXStrings

using CUDA

[ Info: Precompiling LES_ML [9bca47e3-315e-42b6-a9a0-21ad79062dce]

​

​

N = (256,256)

UPC = 2       

​

​

x= collect(LinRange(-pi,pi,N[1]+1))

y = collect(LinRange(-pi,pi,N[2]+1))

​

fine_mesh = gen_mesh(x,y,UPC = UPC,use_GPU = false)

​

# number of unknowns per cell

​

J = (8,8) # compression in each direction

coarse_mesh = gen_coarse_from_fine_mesh(fine_mesh,J)

MP = gen_mesh_pair(fine_mesh,coarse_mesh)

0

​

FA_filter = gen_FA_filter(J,2) #|> gpu

​

┌ Info: The CUDA function is being called but CUDA.jl is not functional.
└ Defaulting back to the CPU. (No action is required if you want to run on the CPU).
┌ Warning: Layer with Float32 parameters got Float64 input.
│   The input will be converted, but any earlier layers may be very slow.
│   layer = ConvTranspose((8, 8), 2 => 2, stride=8, bias=false)  # 256 parameters
│   summary(x) = "32×32×2×1 Array{Float64, 4}"
└ @ Flux ~/.julia/packages/Flux/MtsAN/src/layers/stateless.jl:60

Conv((8, 8), 2 => 2, stride=8, bias=false)  # 256 parameters

forcing(x) = sin.(4*x[2])

​

F = fine_mesh.eval_function(forcing)

F = cat(F,zeros(size(F)),dims = fine_mesh.dims + 1)

​

​

256×256×2×1 Array{Float64, 4}:
[:, :, 1, 1] =
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 ⋮                                     ⋱                       ⋮
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689     -0.24298  -0.14673  -0.0490677
 0.0490677  0.14673  0.24298  0.33689  …  -0.24298  -0.14673  -0.0490677

[:, :, 2, 1] =
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱       ⋮                        ⋮
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0

setup = gen_setup(fine_mesh)

setup_bar = gen_setup(coarse_mesh)

LES_ML.setup_struct(LES_ML.operators_struct(Conv((3, 3), 2 => 1, bias=false), Conv((3, 3), 1 => 2, bias=false), LES_ML.var"#C#86"{Float64, Int64}(0.1963495408493623, Core.Box(Conv((3, 3), 2 => 4, bias=false)), Core.Box(Conv((3, 3), 2 => 4, bias=false)), 2, Core.Box(Conv((3, 3), 4 => 2, bias=false))), Conv((3, 3), 2 => 2, bias=false), Conv((3, 3), 2 => 1, bias=false)), LES_ML.var"#pressure_poisson#40"{LES_ML.var"#pressure_poisson#32#41", Array{Float64, 4}}(LES_ML.var"#pressure_poisson#32#41"(Core.Box(2)), Core.Box([0.0 1.0 … 1.0 1.0; 1.0 1.0 … 1.0 1.0; … ; 1.0 1.0 … 1.0 1.0; 1.0 1.0 … 1.0 1.0]), [1.0 0.9967912836197286 … 3.948859004456395 0.9967912836197286; 0.9967912836197286 1.9935825672394571 … 4.9456502880761235 1.9935825672394571; … ; 3.948859004456395 4.9456502880761235 … 7.89771800891279 4.9456502880761235; 0.9967912836197286 1.9935825672394571 … 4.9456502880761235 1.9935825672394571;;;;]), LES_ML.grid_swapper(LES_ML.mesh_struct(2, (32, 32), [-3.043417883165112 -3.043417883165112 … -3.043417883165112 -3.043417883165112; -2.8470683423157497 -2.8470683423157497 … -2.8470683423157497 -2.8470683423157497; … ; 2.8470683423157497 2.8470683423157497 … 2.8470683423157497 2.8470683423157497; 3.043417883165112 3.043417883165112 … 3.043417883165112 3.043417883165112;;; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; … ; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112;;;;], [0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; … ; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623;;; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; … ; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623;;;;], Any[[-3.141592653589793, -2.945243112740431, -2.7488935718910685, -2.552544031041707, -2.356194490192345, -2.1598449493429825, -1.963495408493621, -1.7671458676442588, -1.5707963267948966, -1.3744467859455343  …  1.3744467859455343, 1.5707963267948966, 1.7671458676442588, 1.963495408493621, 2.1598449493429825, 2.356194490192345, 2.552544031041707, 2.7488935718910685, 2.945243112740431, 3.141592653589793], [-3.141592653589793, -2.945243112740431, -2.7488935718910685, -2.552544031041707, -2.356194490192345, -2.1598449493429825, -1.963495408493621, -1.7671458676442588, -1.5707963267948966, -1.3744467859455343  …  1.3744467859455343, 1.5707963267948966, 1.7671458676442588, 1.963495408493621, 2.1598449493429825, 2.356194490192345, 2.552544031041707, 2.7488935718910685, 2.945243112740431, 3.141592653589793]], [0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;], LES_ML.var"#eval_function#299"{Int64}(Core.Box([-3.043417883165112 -3.043417883165112 … -3.043417883165112 -3.043417883165112; -2.8470683423157497 -2.8470683423157497 … -2.8470683423157497 -2.8470683423157497; … ; 2.8470683423157497 2.8470683423157497 … 2.8470683423157497 2.8470683423157497; 3.043417883165112 3.043417883165112 … 3.043417883165112 3.043417883165112;;; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; … ; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112;;;;]), 2), LES_ML.var"#ip#302"{LES_ML.var"#ip#286#303", Int64}(LES_ML.var"#ip#286#303"(), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2), LES_ML.var"#integ#305"{Bool, LES_ML.var"#integ#288#306", Int64}(false, LES_ML.var"#integ#288#306"(), Core.Box(LES_ML.var"#ip#302"{LES_ML.var"#ip#286#303", Int64}(LES_ML.var"#ip#286#303"(), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2)), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2), 2, false), LES_ML.var"#A_c_s#23"{Tuple{Int64, Int64}}(Core.Box(Conv((3, 3), 2 => 2, bias=false)), (1, 1)), LES_ML.var"#A_s_c#24"{Array{Float32, 4}, Array{Float64, 4}, Tuple{Int64, Int64}}(Core.Box(Conv((3, 3), 2 => 2, bias=false)), [0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314; … ; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314;;; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314; … ; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314;;;;], [0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;], (1, 1)), [0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314; … ; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314;;; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314; … ; 0.03855314 0.03855314 … 0.03855314 0.03855314; 0.03855314 0.03855314 … 0.03855314 0.03855314;;;;], [0.19634955 0.19634955 … 0.19634955 0.19634955; 0.19634955 0.19634955 … 0.19634955 0.19634955; … ; 0.19634955 0.19634955 … 0.19634955 0.19634955; 0.19634955 0.19634955 … 0.19634955 0.19634955;;; 0.19634955 0.19634955 … 0.19634955 0.19634955; 0.19634955 0.19634955 … 0.19634955 0.19634955; … ; 0.19634955 0.19634955 … 0.19634955 0.19634955; 0.19634955 0.19634955 … 0.19634955 0.19634955;;;;], [0.19634953 0.19634953 … 0.19634953 0.19634953; 0.19634953 0.19634953 … 0.19634953 0.19634953; … ; 0.19634953 0.19634953 … 0.19634953 0.19634953; 0.19634953 0.19634953 … 0.19634953 0.19634953;;; 0.19634953 0.19634953 … 0.19634953 0.19634953; 0.19634953 0.19634953 … 0.19634953 0.19634953; … ; 0.19634953 0.19634953 … 0.19634953 0.19634953; 0.19634953 0.19634953 … 0.19634953 0.19634953;;;;]), LES_ML.mesh_struct(2, (32, 32), [-3.043417883165112 -3.043417883165112 … -3.043417883165112 -3.043417883165112; -2.8470683423157497 -2.8470683423157497 … -2.8470683423157497 -2.8470683423157497; … ; 2.8470683423157497 2.8470683423157497 … 2.8470683423157497 2.8470683423157497; 3.043417883165112 3.043417883165112 … 3.043417883165112 3.043417883165112;;; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; … ; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112;;;;], [0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; … ; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623;;; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; … ; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623; 0.1963495408493623 0.1963495408493623 … 0.1963495408493623 0.1963495408493623;;;;], Any[[-3.141592653589793, -2.945243112740431, -2.7488935718910685, -2.552544031041707, -2.356194490192345, -2.1598449493429825, -1.963495408493621, -1.7671458676442588, -1.5707963267948966, -1.3744467859455343  …  1.3744467859455343, 1.5707963267948966, 1.7671458676442588, 1.963495408493621, 2.1598449493429825, 2.356194490192345, 2.552544031041707, 2.7488935718910685, 2.945243112740431, 3.141592653589793], [-3.141592653589793, -2.945243112740431, -2.7488935718910685, -2.552544031041707, -2.356194490192345, -2.1598449493429825, -1.963495408493621, -1.7671458676442588, -1.5707963267948966, -1.3744467859455343  …  1.3744467859455343, 1.5707963267948966, 1.7671458676442588, 1.963495408493621, 2.1598449493429825, 2.356194490192345, 2.552544031041707, 2.7488935718910685, 2.945243112740431, 3.141592653589793]], [0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;], LES_ML.var"#eval_function#299"{Int64}(Core.Box([-3.043417883165112 -3.043417883165112 … -3.043417883165112 -3.043417883165112; -2.8470683423157497 -2.8470683423157497 … -2.8470683423157497 -2.8470683423157497; … ; 2.8470683423157497 2.8470683423157497 … 2.8470683423157497 2.8470683423157497; 3.043417883165112 3.043417883165112 … 3.043417883165112 3.043417883165112;;; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; … ; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112; -3.043417883165112 -2.8470683423157497 … 2.8470683423157497 3.043417883165112;;;;]), 2), LES_ML.var"#ip#302"{LES_ML.var"#ip#286#303", Int64}(LES_ML.var"#ip#286#303"(), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2), LES_ML.var"#integ#305"{Bool, LES_ML.var"#integ#288#306", Int64}(false, LES_ML.var"#integ#288#306"(), Core.Box(LES_ML.var"#ip#302"{LES_ML.var"#ip#286#303", Int64}(LES_ML.var"#ip#286#303"(), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2)), Core.Box([0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; … ; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539; 0.03855314219175539 0.03855314219175539 … 0.03855314219175539 0.03855314219175539;;;;]), 2), 2, false))

setup.O.G.weight

3×3×1×2 Array{Float32, 4}:
[:, :, 1, 1] =
 0.0    0.0     0.0
 0.0  -40.7437  0.0
 0.0   40.7437  0.0

[:, :, 1, 2] =
 0.0    0.0      0.0
 0.0  -40.7437  40.7437
 0.0    0.0      0.0

max_k = 10

energy_norm = 1

number_of_simulations = 1

​

setup = gen_setup(fine_mesh)

setup_bar = gen_setup(coarse_mesh)

KF_rhs = gen_rhs(setup,0*F;Re = 1000,damping = 0.0)

​

V = gen_random_field(fine_mesh.N,max_k,norm = energy_norm,samples = (fine_mesh.UPC,number_of_simulations))

​

​

    

MV = setup.O.M(padding(V,(1,1),circular = true))

​

​

​

p = setup.PS(MV)

​

Gp = setup.O.G(padding(p,(1,1),circular =true))

​

V0 = V-Gp

​

setup.O.M(V0)[:,:,1,1]

​

KF_rhs(V0,fine_mesh,0)

​

256×256×2×1 Array{Float64, 4}:
[:, :, 1, 1] =
 0.69956   0.454003  0.21296    …   1.33487     1.15204     0.936471
 0.741663  0.518522  0.293127       1.2737      1.13021     0.949529
 0.771421  0.577221  0.373878       1.1833      1.08402     0.943944
 0.785095  0.625359  0.449728       1.06432     1.01246     0.917268
 0.780237  0.659278  0.516081       0.918998    0.916119    0.868451
 0.755754  0.676523  0.569431   …   0.751079    0.79708     0.797901
 0.711907  0.67597   0.607274       0.565534    0.658662    0.707498
 0.650191  0.657623  0.628316       0.368245    0.505481    0.600221
 0.573251  0.622594  0.632427       0.16579     0.342784    0.47998
 0.484366  0.573111  0.620442      -0.0351337   0.17638     0.351512
 0.38763   0.512092  0.594075   …  -0.227827    0.0121241   0.219809
 0.287355  0.442978  0.556024      -0.406216   -0.144215    0.0900132
 0.188118  0.369689  0.509357      -0.564833   -0.287375   -0.032918
 ⋮                              ⋱                           ⋮
 1.12314   1.12043   1.10633        1.10766     1.11371     1.11958
 0.955226  0.91329   0.869688   …   1.09526     1.04557     0.998744
 0.80813   0.726274  0.651378       1.09832     0.995935    0.898235
 0.687132  0.566072  0.45922        1.11659     0.966537    0.821607
 0.595493  0.437381  0.299118       1.14827     0.957301    0.770532
 0.534383  0.342769  0.174833       1.19016     0.966436    0.744698
 0.502938  0.282645  0.0879924  …   1.23784     0.990602    0.741965
 0.498457  0.255398  0.0381064      1.28602     1.02519     0.758614
 0.516676  0.25768   0.0228253      1.32886     1.06465     0.789638
 0.552171  0.284711  0.0382059      1.36041     1.10297     0.829152
 0.59878   0.330702  0.0790843      1.37503     1.134       0.870897
 0.650017  0.389308  0.139473   …   1.36781     1.15202     0.908593

[:, :, 2, 1] =
  1.32169    1.27958     1.21507    …   1.25174     1.31291      1.33475
  1.40336    1.3736      1.3149         1.26118     1.35158      1.39777
  1.42634    1.41267     1.36454        1.20913     1.32811      1.39967
  1.38694    1.39179     1.35787        1.09646     1.24178      1.33812
  1.28293    1.30742     1.29017        0.925427    1.09335      1.21238
  1.11409    1.15793     1.15849    …   0.69972     0.885264     1.02368
  0.8827     0.944413    0.962758       0.424954    0.622241     0.775422
  0.594137   0.671077    0.706107       0.108748    0.311202     0.473898
  0.257005   0.345889    0.395375      -0.238794   -0.037867     0.128533
 -0.116455  -0.0197229   0.0412978     -0.605107   -0.412417    -0.248159
 -0.510797  -0.410521   -0.34141    …  -0.975318   -0.796933    -0.640593
 -0.907845  -0.808605   -0.735316      -1.33255    -1.17393     -1.03077
 -1.28757   -1.19375    -1.12024       -1.65883    -1.52442     -1.39906
  ⋮                                 ⋱                            ⋮
 -1.45624   -1.28833    -1.08118       -1.65761    -1.64521     -1.57707
 -1.33261   -1.18552    -0.998501   …  -1.47969    -1.48275     -1.43312
 -1.14964   -1.02864    -0.86844       -1.2374     -1.25566     -1.22627
 -0.918113  -0.826473   -0.697782      -0.946747   -0.978423    -0.969188
 -0.650506  -0.589396   -0.494785      -0.62531    -0.667205    -0.67634
 -0.360072  -0.328625   -0.268501      -0.290955   -0.338639    -0.362803
 -0.060037  -0.055556   -0.0283105  …   0.0393731  -0.00880284  -0.043389
  0.237086   0.218866    0.216583       0.350409    0.30757      0.268108
  0.519836   0.484342    0.457312       0.629218    0.597672     0.559351
  0.778023   0.731416    0.685423       0.865424    0.850803     0.81977
  1.00274    0.951502    0.892896       1.05123     1.05845      1.04043
  1.1862     1.13665     1.07196    …   1.18116     1.2141       1.21407

​

heatmap(Array(FA_filter(V0))[:,:,2,1])

dt = 0.01

save_every = 10

t_start = 0

t_end = 5

pre_allocate = true

​

t_data,sim_data = simulate(V0,fine_mesh,dt,t_start,t_end,KF_rhs,save_every = save_every,pre_allocate = pre_allocate) 

0

0.0%┣                                            ┫ 0/500 [00:01<-11:-34, -1s/it]
0.2%┣                                          ┫ 1/500 [00:02<Inf:Inf, InfGs/it]
0.4%┣▏                                              ┫ 2/500 [00:03<22:38, 3s/it]
0.6%┣▎                                              ┫ 3/500 [00:03<11:36, 1s/it]
0.8%┣▍                                              ┫ 4/500 [00:03<07:55, 1it/s]
1.0%┣▌                                              ┫ 5/500 [00:03<06:05, 1it/s]
1.2%┣▋                                              ┫ 6/500 [00:03<04:58, 2it/s]
1.4%┣▋                                              ┫ 7/500 [00:03<04:14, 2it/s]
1.6%┣▊                                              ┫ 8/500 [00:03<03:42, 2it/s]
1.8%┣▉                                              ┫ 9/500 [00:03<03:18, 2it/s]
2.0%┣█                                             ┫ 10/500 [00:04<03:31, 2it/s]
2.2%┣█                                             ┫ 11/500 [00:04<03:14, 3it/s]
2.4%┣█                                             ┫ 12/500 [00:04<02:59, 3it/s]
2.6%┣█▏                                            ┫ 13/500 [00:04<02:46, 3it/s]
2.8%┣█▎                                            ┫ 14/500 [00:04<02:36, 3it/s]
3.0%┣█▍                                            ┫ 15/500 [00:04<02:27, 3it/s]
3.2%┣█▌                                            ┫ 16/500 [00:04<02:20, 3it/s]
3.4%┣█▋                                            ┫ 17/500 [00:04<02:13, 4it/s]
3.6%┣█▋                                            ┫ 18/500 [00:04<02:07, 4it/s]
3.8%┣█▊                                            ┫ 19/500 [00:05<02:01, 4it/s]
4.0%┣█▉                                            ┫ 20/500 [00:05<01:57, 4it/s]
4.2%┣██                                            ┫ 21/500 [00:05<01:52, 4it/s]
4.4%┣██                                            ┫ 22/500 [00:05<01:48, 4it/s]
4.6%┣██▏                                           ┫ 23/500 [00:05<01:45, 5it/s]
4.8%┣██▏                                           ┫ 24/500 [00:05<01:41, 5it/s]
5.0%┣██▎                                           ┫ 25/500 [00:05<01:38, 5it/s]
5.2%┣██▍                                           ┫ 26/500 [00:05<01:35, 5it/s]
5.4%┣██▌                                           ┫ 27/500 [00:05<01:33, 5it/s]
5.6%┣██▋                                           ┫ 28/500 [00:05<01:30, 5it/s]
5.8%┣██▊                                           ┫ 29/500 [00:05<01:28, 5it/s]
6.0%┣██▊                                           ┫ 30/500 [00:05<01:26, 5it/s]
6.2%┣██▉                                           ┫ 31/500 [00:05<01:24, 6it/s]
6.4%┣███                                           ┫ 32/500 [00:05<01:22, 6it/s]
6.6%┣███                                           ┫ 33/500 [00:06<01:20, 6it/s]
6.8%┣███▏                                          ┫ 34/500 [00:06<01:19, 6it/s]
7.0%┣███▏                                          ┫ 35/500 [00:06<01:17, 6it/s]
7.2%┣███▎                                          ┫ 36/500 [00:06<01:16, 6it/s]
7.4%┣███▍                                          ┫ 37/500 [00:06<01:15, 6it/s]
7.6%┣███▌                                          ┫ 38/500 [00:06<01:13, 6it/s]
7.8%┣███▋                                          ┫ 39/500 [00:06<01:12, 6it/s]
8.0%┣███▊                                          ┫ 40/500 [00:06<01:11, 6it/s]
8.2%┣███▊                                          ┫ 41/500 [00:06<01:10, 7it/s]
8.4%┣███▉                                          ┫ 42/500 [00:06<01:09, 7it/s]
8.6%┣████                                          ┫ 43/500 [00:06<01:08, 7it/s]
8.8%┣████                                          ┫ 44/500 [00:06<01:07, 7it/s]
9.0%┣████▏                                         ┫ 45/500 [00:06<01:06, 7it/s]
9.2%┣████▎                                         ┫ 46/500 [00:06<01:05, 7it/s]
9.4%┣████▎                                         ┫ 47/500 [00:07<01:04, 7it/s]
9.6%┣████▍                                         ┫ 48/500 [00:07<01:04, 7it/s]
9.8%┣████▌                                         ┫ 49/500 [00:07<01:03, 7it/s]
10.0%┣████▌                                        ┫ 50/500 [00:07<01:02, 7it/s]
10.2%┣████▋                                        ┫ 51/500 [00:07<01:01, 7it/s]
10.4%┣████▊                                        ┫ 52/500 [00:07<01:01, 7it/s]
10.6%┣████▊                                        ┫ 53/500 [00:07<01:00, 7it/s]
10.8%┣████▉                                        ┫ 54/500 [00:07<00:59, 8it/s]
11.0%┣█████                                        ┫ 55/500 [00:07<00:59, 8it/s]
11.2%┣█████                                        ┫ 56/500 [00:07<00:58, 8it/s]
11.4%┣█████▏                                       ┫ 57/500 [00:07<00:57, 8it/s]
11.6%┣█████▏                                       ┫ 58/500 [00:07<00:57, 8it/s]
11.8%┣█████▎                                       ┫ 59/500 [00:07<00:56, 8it/s]
12.0%┣█████▍                                       ┫ 60/500 [00:07<00:56, 8it/s]
12.2%┣█████▌                                       ┫ 61/500 [00:08<00:55, 8it/s]
12.4%┣█████▋                                       ┫ 62/500 [00:08<00:55, 8it/s]
12.6%┣█████▊                                       ┫ 63/500 [00:08<00:54, 8it/s]
12.8%┣█████▊                                       ┫ 64/500 [00:08<00:54, 8it/s]
13.0%┣█████▉                                       ┫ 65/500 [00:08<00:53, 8it/s]
13.2%┣██████                                       ┫ 66/500 [00:08<00:53, 8it/s]
13.4%┣██████                                       ┫ 67/500 [00:08<00:52, 8it/s]
13.6%┣██████▏                                      ┫ 68/500 [00:08<00:52, 8it/s]
13.8%┣██████▏                                      ┫ 69/500 [00:08<00:51, 8it/s]
14.0%┣██████▎                                      ┫ 70/500 [00:08<00:51, 8it/s]
14.2%┣██████▍                                      ┫ 71/500 [00:08<00:50, 9it/s]
14.4%┣██████▌                                      ┫ 72/500 [00:08<00:50, 9it/s]
14.6%┣██████▋                                      ┫ 73/500 [00:08<00:50, 9it/s]
14.8%┣██████▋                                      ┫ 74/500 [00:08<00:49, 9it/s]
15.0%┣██████▊                                      ┫ 75/500 [00:08<00:49, 9it/s]
15.2%┣██████▉                                      ┫ 76/500 [00:09<00:48, 9it/s]
15.4%┣███████                                      ┫ 77/500 [00:09<00:48, 9it/s]
15.6%┣███████                                      ┫ 78/500 [00:09<00:48, 9it/s]
15.8%┣███████                                      ┫ 79/500 [00:09<00:47, 9it/s]
16.0%┣███████▏                                     ┫ 80/500 [00:09<00:47, 9it/s]
16.2%┣███████▎                                     ┫ 81/500 [00:09<00:47, 9it/s]
16.4%┣███████▍                                     ┫ 82/500 [00:09<00:46, 9it/s]
16.6%┣███████▌                                     ┫ 83/500 [00:09<00:46, 9it/s]
16.8%┣███████▋                                     ┫ 84/500 [00:09<00:46, 9it/s]
17.0%┣███████▋                                     ┫ 85/500 [00:09<00:45, 9it/s]
17.2%┣███████▊                                     ┫ 86/500 [00:09<00:45, 9it/s]
17.4%┣███████▉                                     ┫ 87/500 [00:09<00:45, 9it/s]
17.6%┣████████                                     ┫ 88/500 [00:09<00:44, 9it/s]
17.8%┣████████                                     ┫ 89/500 [00:09<00:44, 9it/s]
18.0%┣████████                                     ┫ 90/500 [00:10<00:44, 9it/s]
18.2%┣████████▏                                    ┫ 91/500 [00:10<00:44, 9it/s]
18.4%┣████████▎                                    ┫ 92/500 [00:10<00:43, 9it/s]
18.6%┣████████▍                                    ┫ 93/500 [00:10<00:43, 9it/s]
18.8%┣████████▌                                    ┫ 94/500 [00:10<00:43, 9it/s]
19.0%┣████████▍                                   ┫ 95/500 [00:10<00:43, 10it/s]
19.2%┣████████▌                                   ┫ 96/500 [00:10<00:42, 10it/s]
19.4%┣████████▌                                   ┫ 97/500 [00:10<00:42, 10it/s]
19.6%┣████████▋                                   ┫ 98/500 [00:10<00:42, 10it/s]
19.8%┣████████▊                                   ┫ 99/500 [00:10<00:42, 10it/s]
20.0%┣████████▋                                  ┫ 100/500 [00:10<00:41, 10it/s]
20.2%┣████████▊                                  ┫ 101/500 [00:10<00:41, 10it/s]

20.4%┣████████▊                                  ┫ 102/500 [00:10<00:41, 10it/s]
20.6%┣████████▉                                  ┫ 103/500 [00:10<00:41, 10it/s]
20.8%┣█████████                                  ┫ 104/500 [00:11<00:40, 10it/s]
21.0%┣█████████                                  ┫ 105/500 [00:11<00:40, 10it/s]
21.2%┣█████████▏                                 ┫ 106/500 [00:11<00:40, 10it/s]
21.4%┣█████████▏                                 ┫ 107/500 [00:11<00:40, 10it/s]
21.6%┣█████████▎                                 ┫ 108/500 [00:11<00:40, 10it/s]
21.8%┣█████████▍                                 ┫ 109/500 [00:11<00:39, 10it/s]
22.0%┣█████████▌                                 ┫ 110/500 [00:11<00:39, 10it/s]
22.2%┣█████████▌                                 ┫ 111/500 [00:11<00:39, 10it/s]
22.4%┣█████████▋                                 ┫ 112/500 [00:11<00:39, 10it/s]
22.6%┣█████████▊                                 ┫ 113/500 [00:11<00:38, 10it/s]
22.8%┣█████████▉                                 ┫ 114/500 [00:11<00:38, 10it/s]
23.0%┣██████████                                 ┫ 115/500 [00:11<00:38, 10it/s]
23.2%┣██████████                                 ┫ 116/500 [00:11<00:38, 10it/s]
23.4%┣██████████                                 ┫ 117/500 [00:11<00:38, 10it/s]
23.6%┣██████████▏                                ┫ 118/500 [00:11<00:37, 10it/s]
23.8%┣██████████▎                                ┫ 119/500 [00:12<00:37, 10it/s]
24.0%┣██████████▎                                ┫ 120/500 [00:12<00:37, 10it/s]
24.2%┣██████████▍                                ┫ 121/500 [00:12<00:37, 10it/s]
24.4%┣██████████▌                                ┫ 122/500 [00:12<00:37, 10it/s]
24.6%┣██████████▋                                ┫ 123/500 [00:12<00:36, 10it/s]
24.8%┣██████████▋                                ┫ 124/500 [00:12<00:36, 10it/s]
25.0%┣██████████▊                                ┫ 125/500 [00:12<00:36, 10it/s]
25.2%┣██████████▉                                ┫ 126/500 [00:12<00:36, 10it/s]
25.4%┣███████████                                ┫ 127/500 [00:12<00:36, 10it/s]
25.6%┣███████████                                ┫ 128/500 [00:12<00:36, 10it/s]
25.8%┣███████████                                ┫ 129/500 [00:12<00:35, 10it/s]
26.0%┣███████████▏                               ┫ 130/500 [00:12<00:35, 11it/s]
26.2%┣███████████▎                               ┫ 131/500 [00:12<00:35, 11it/s]
26.4%┣███████████▍                               ┫ 132/500 [00:12<00:35, 11it/s]
26.6%┣███████████▍                               ┫ 133/500 [00:13<00:35, 11it/s]
26.8%┣███████████▌                               ┫ 134/500 [00:13<00:35, 11it/s]
27.0%┣███████████▋                               ┫ 135/500 [00:13<00:34, 11it/s]
27.2%┣███████████▊                               ┫ 136/500 [00:13<00:34, 11it/s]
27.4%┣███████████▉                               ┫ 137/500 [00:13<00:34, 11it/s]
27.6%┣███████████▉                               ┫ 138/500 [00:13<00:34, 11it/s]
27.8%┣████████████                               ┫ 139/500 [00:13<00:34, 11it/s]
28.0%┣████████████                               ┫ 140/500 [00:13<00:34, 11it/s]
28.2%┣████████████▏                              ┫ 141/500 [00:13<00:34, 11it/s]
28.4%┣████████████▏                              ┫ 142/500 [00:13<00:33, 11it/s]
28.6%┣████████████▎                              ┫ 143/500 [00:13<00:33, 11it/s]
28.8%┣████████████▍                              ┫ 144/500 [00:13<00:33, 11it/s]
29.0%┣████████████▌                              ┫ 145/500 [00:13<00:33, 11it/s]
29.2%┣████████████▋                              ┫ 146/500 [00:13<00:33, 11it/s]
29.4%┣████████████▋                              ┫ 147/500 [00:14<00:33, 11it/s]
29.6%┣████████████▊                              ┫ 148/500 [00:14<00:32, 11it/s]
29.8%┣████████████▉                              ┫ 149/500 [00:14<00:32, 11it/s]
30.0%┣█████████████                              ┫ 150/500 [00:14<00:32, 11it/s]
30.2%┣█████████████                              ┫ 151/500 [00:14<00:32, 11it/s]
30.4%┣█████████████                              ┫ 152/500 [00:14<00:32, 11it/s]
30.6%┣█████████████▏                             ┫ 153/500 [00:14<00:32, 11it/s]
30.8%┣█████████████▎                             ┫ 154/500 [00:14<00:32, 11it/s]
31.0%┣█████████████▎                             ┫ 155/500 [00:14<00:32, 11it/s]
31.2%┣█████████████▍                             ┫ 156/500 [00:14<00:31, 11it/s]
31.4%┣█████████████▌                             ┫ 157/500 [00:14<00:31, 11it/s]
31.6%┣█████████████▋                             ┫ 158/500 [00:14<00:31, 11it/s]
31.8%┣█████████████▊                             ┫ 159/500 [00:14<00:31, 11it/s]
32.0%┣█████████████▊                             ┫ 160/500 [00:14<00:31, 11it/s]
32.2%┣█████████████▉                             ┫ 161/500 [00:14<00:31, 11it/s]
32.4%┣██████████████                             ┫ 162/500 [00:15<00:31, 11it/s]
32.6%┣██████████████                             ┫ 163/500 [00:15<00:30, 11it/s]
32.8%┣██████████████                             ┫ 164/500 [00:15<00:30, 11it/s]
33.0%┣██████████████▏                            ┫ 165/500 [00:15<00:30, 11it/s]
33.2%┣██████████████▎                            ┫ 166/500 [00:15<00:30, 11it/s]
33.4%┣██████████████▍                            ┫ 167/500 [00:15<00:30, 11it/s]
33.6%┣██████████████▌                            ┫ 168/500 [00:15<00:30, 11it/s]
33.8%┣██████████████▌                            ┫ 169/500 [00:15<00:30, 11it/s]
34.0%┣██████████████▋                            ┫ 170/500 [00:15<00:29, 11it/s]
34.2%┣██████████████▊                            ┫ 171/500 [00:15<00:29, 11it/s]
34.4%┣██████████████▉                            ┫ 172/500 [00:15<00:29, 11it/s]
34.6%┣██████████████▉                            ┫ 173/500 [00:15<00:29, 11it/s]
34.8%┣███████████████                            ┫ 174/500 [00:15<00:29, 11it/s]
35.0%┣███████████████                            ┫ 175/500 [00:15<00:29, 11it/s]
35.2%┣███████████████▏                           ┫ 176/500 [00:16<00:29, 11it/s]
35.4%┣███████████████▏                           ┫ 177/500 [00:16<00:29, 11it/s]
35.6%┣███████████████▎                           ┫ 178/500 [00:16<00:28, 11it/s]
35.8%┣███████████████▍                           ┫ 179/500 [00:16<00:28, 11it/s]
36.0%┣███████████████▌                           ┫ 180/500 [00:16<00:28, 11it/s]
36.2%┣███████████████▋                           ┫ 181/500 [00:16<00:28, 11it/s]
36.4%┣███████████████▋                           ┫ 182/500 [00:16<00:28, 11it/s]
36.6%┣███████████████▊                           ┫ 183/500 [00:16<00:28, 11it/s]
36.8%┣███████████████▉                           ┫ 184/500 [00:16<00:28, 11it/s]
37.0%┣████████████████                           ┫ 185/500 [00:16<00:28, 11it/s]
37.2%┣████████████████                           ┫ 186/500 [00:16<00:28, 11it/s]
37.4%┣████████████████                           ┫ 187/500 [00:16<00:27, 11it/s]
37.6%┣████████████████▏                          ┫ 188/500 [00:16<00:27, 11it/s]
37.8%┣████████████████▎                          ┫ 189/500 [00:16<00:27, 11it/s]
38.0%┣████████████████▍                          ┫ 190/500 [00:16<00:27, 11it/s]
38.2%┣████████████████▍                          ┫ 191/500 [00:17<00:27, 11it/s]
38.4%┣████████████████▌                          ┫ 192/500 [00:17<00:27, 11it/s]
38.6%┣████████████████▋                          ┫ 193/500 [00:17<00:27, 11it/s]
38.8%┣████████████████▊                          ┫ 194/500 [00:17<00:27, 11it/s]
39.0%┣████████████████▊                          ┫ 195/500 [00:17<00:27, 12it/s]
39.2%┣████████████████▉                          ┫ 196/500 [00:17<00:26, 12it/s]
39.4%┣█████████████████                          ┫ 197/500 [00:17<00:26, 12it/s]
39.6%┣█████████████████                          ┫ 198/500 [00:17<00:26, 12it/s]
39.8%┣█████████████████▏                         ┫ 199/500 [00:17<00:26, 12it/s]
40.0%┣█████████████████▏                         ┫ 200/500 [00:17<00:26, 12it/s]
40.2%┣█████████████████▎                         ┫ 201/500 [00:17<00:26, 12it/s]
40.4%┣█████████████████▍                         ┫ 202/500 [00:17<00:26, 12it/s]
40.6%┣█████████████████▌                         ┫ 203/500 [00:17<00:26, 12it/s]
40.8%┣█████████████████▌                         ┫ 204/500 [00:17<00:26, 12it/s]

41.0%┣█████████████████▋                         ┫ 205/500 [00:18<00:25, 12it/s]
41.2%┣█████████████████▊                         ┫ 206/500 [00:18<00:25, 12it/s]
41.4%┣█████████████████▉                         ┫ 207/500 [00:18<00:25, 12it/s]
41.6%┣█████████████████▉                         ┫ 208/500 [00:18<00:25, 12it/s]
41.8%┣██████████████████                         ┫ 209/500 [00:18<00:25, 12it/s]
42.0%┣██████████████████                         ┫ 210/500 [00:18<00:25, 12it/s]
42.2%┣██████████████████▏                        ┫ 211/500 [00:18<00:25, 12it/s]
42.4%┣██████████████████▎                        ┫ 212/500 [00:18<00:25, 12it/s]
42.6%┣██████████████████▎                        ┫ 213/500 [00:18<00:25, 12it/s]
42.8%┣██████████████████▍                        ┫ 214/500 [00:18<00:24, 12it/s]
43.0%┣██████████████████▌                        ┫ 215/500 [00:18<00:24, 12it/s]
43.2%┣██████████████████▋                        ┫ 216/500 [00:18<00:24, 12it/s]
43.4%┣██████████████████▋                        ┫ 217/500 [00:18<00:24, 12it/s]
43.6%┣██████████████████▊                        ┫ 218/500 [00:18<00:24, 12it/s]
43.8%┣██████████████████▉                        ┫ 219/500 [00:19<00:24, 12it/s]
44.0%┣███████████████████                        ┫ 220/500 [00:19<00:24, 12it/s]
44.2%┣███████████████████                        ┫ 221/500 [00:19<00:24, 12it/s]
44.4%┣███████████████████                        ┫ 222/500 [00:19<00:24, 12it/s]
44.6%┣███████████████████▏                       ┫ 223/500 [00:19<00:23, 12it/s]
44.8%┣███████████████████▎                       ┫ 224/500 [00:19<00:23, 12it/s]
45.0%┣███████████████████▍                       ┫ 225/500 [00:19<00:23, 12it/s]
45.2%┣███████████████████▍                       ┫ 226/500 [00:19<00:23, 12it/s]
45.4%┣███████████████████▌                       ┫ 227/500 [00:19<00:23, 12it/s]
45.6%┣███████████████████▋                       ┫ 228/500 [00:19<00:23, 12it/s]
45.8%┣███████████████████▊                       ┫ 229/500 [00:19<00:23, 12it/s]
46.0%┣███████████████████▉                       ┫ 230/500 [00:19<00:23, 12it/s]
46.2%┣███████████████████▉                       ┫ 231/500 [00:19<00:23, 12it/s]
46.4%┣████████████████████                       ┫ 232/500 [00:19<00:23, 12it/s]
46.6%┣████████████████████                       ┫ 233/500 [00:20<00:22, 12it/s]
46.8%┣████████████████████▏                      ┫ 234/500 [00:20<00:22, 12it/s]
47.0%┣████████████████████▏                      ┫ 235/500 [00:20<00:22, 12it/s]
47.2%┣████████████████████▎                      ┫ 236/500 [00:20<00:22, 12it/s]
47.4%┣████████████████████▍                      ┫ 237/500 [00:20<00:22, 12it/s]
47.6%┣████████████████████▌                      ┫ 238/500 [00:20<00:22, 12it/s]
47.8%┣████████████████████▌                      ┫ 239/500 [00:20<00:22, 12it/s]
48.0%┣████████████████████▋                      ┫ 240/500 [00:20<00:22, 12it/s]
48.2%┣████████████████████▊                      ┫ 241/500 [00:20<00:22, 12it/s]
48.4%┣████████████████████▉                      ┫ 242/500 [00:20<00:22, 12it/s]
48.6%┣█████████████████████                      ┫ 243/500 [00:20<00:21, 12it/s]
48.8%┣█████████████████████                      ┫ 244/500 [00:20<00:21, 12it/s]
49.0%┣█████████████████████                      ┫ 245/500 [00:20<00:21, 12it/s]
49.2%┣█████████████████████▏                     ┫ 246/500 [00:20<00:21, 12it/s]
49.4%┣█████████████████████▎                     ┫ 247/500 [00:20<00:21, 12it/s]
49.6%┣█████████████████████▎                     ┫ 248/500 [00:21<00:21, 12it/s]
49.8%┣█████████████████████▍                     ┫ 249/500 [00:21<00:21, 12it/s]
50.0%┣█████████████████████▌                     ┫ 250/500 [00:21<00:21, 12it/s]
50.2%┣█████████████████████▋                     ┫ 251/500 [00:21<00:21, 12it/s]
50.4%┣█████████████████████▊                     ┫ 252/500 [00:21<00:21, 12it/s]
50.6%┣█████████████████████▊                     ┫ 253/500 [00:21<00:20, 12it/s]
50.8%┣█████████████████████▉                     ┫ 254/500 [00:21<00:20, 12it/s]
51.0%┣██████████████████████                     ┫ 255/500 [00:21<00:20, 12it/s]
51.2%┣██████████████████████                     ┫ 256/500 [00:21<00:20, 12it/s]
51.4%┣██████████████████████                     ┫ 257/500 [00:21<00:20, 12it/s]
51.6%┣██████████████████████▏                    ┫ 258/500 [00:21<00:20, 12it/s]
51.8%┣██████████████████████▎                    ┫ 259/500 [00:21<00:20, 12it/s]
52.0%┣██████████████████████▍                    ┫ 260/500 [00:21<00:20, 12it/s]
52.2%┣██████████████████████▌                    ┫ 261/500 [00:21<00:20, 12it/s]
52.4%┣██████████████████████▌                    ┫ 262/500 [00:22<00:20, 12it/s]
52.6%┣██████████████████████▋                    ┫ 263/500 [00:22<00:20, 12it/s]
52.8%┣██████████████████████▊                    ┫ 264/500 [00:22<00:19, 12it/s]
53.0%┣██████████████████████▉                    ┫ 265/500 [00:22<00:19, 12it/s]
53.2%┣██████████████████████▉                    ┫ 266/500 [00:22<00:19, 12it/s]
53.4%┣███████████████████████                    ┫ 267/500 [00:22<00:19, 12it/s]
53.6%┣███████████████████████                    ┫ 268/500 [00:22<00:19, 12it/s]
53.8%┣███████████████████████▏                   ┫ 269/500 [00:22<00:19, 12it/s]
54.0%┣███████████████████████▏                   ┫ 270/500 [00:22<00:19, 12it/s]
54.2%┣███████████████████████▎                   ┫ 271/500 [00:22<00:19, 12it/s]
54.4%┣███████████████████████▍                   ┫ 272/500 [00:22<00:19, 12it/s]
54.6%┣███████████████████████▌                   ┫ 273/500 [00:22<00:19, 12it/s]
54.8%┣███████████████████████▋                   ┫ 274/500 [00:22<00:18, 12it/s]
55.0%┣███████████████████████▋                   ┫ 275/500 [00:22<00:18, 12it/s]
55.2%┣███████████████████████▊                   ┫ 276/500 [00:22<00:18, 12it/s]
55.4%┣███████████████████████▉                   ┫ 277/500 [00:23<00:18, 12it/s]
55.6%┣████████████████████████                   ┫ 278/500 [00:23<00:18, 12it/s]
55.8%┣████████████████████████                   ┫ 279/500 [00:23<00:18, 12it/s]
56.0%┣████████████████████████                   ┫ 280/500 [00:23<00:18, 12it/s]
56.2%┣████████████████████████▏                  ┫ 281/500 [00:23<00:18, 12it/s]
56.4%┣████████████████████████▎                  ┫ 282/500 [00:23<00:18, 12it/s]
56.6%┣████████████████████████▍                  ┫ 283/500 [00:23<00:18, 12it/s]
56.8%┣████████████████████████▍                  ┫ 284/500 [00:23<00:18, 12it/s]
57.0%┣████████████████████████▌                  ┫ 285/500 [00:23<00:18, 12it/s]
57.2%┣████████████████████████▋                  ┫ 286/500 [00:23<00:17, 12it/s]
57.4%┣████████████████████████▊                  ┫ 287/500 [00:23<00:17, 12it/s]
57.6%┣████████████████████████▊                  ┫ 288/500 [00:23<00:17, 12it/s]
57.8%┣████████████████████████▉                  ┫ 289/500 [00:23<00:17, 12it/s]
58.0%┣█████████████████████████                  ┫ 290/500 [00:23<00:17, 12it/s]
58.2%┣█████████████████████████                  ┫ 291/500 [00:24<00:17, 12it/s]
58.4%┣█████████████████████████▏                 ┫ 292/500 [00:24<00:17, 12it/s]
58.6%┣█████████████████████████▏                 ┫ 293/500 [00:24<00:17, 12it/s]
58.8%┣█████████████████████████▎                 ┫ 294/500 [00:24<00:17, 12it/s]
59.0%┣█████████████████████████▍                 ┫ 295/500 [00:24<00:17, 12it/s]
59.2%┣█████████████████████████▌                 ┫ 296/500 [00:24<00:17, 12it/s]
59.4%┣█████████████████████████▌                 ┫ 297/500 [00:24<00:16, 12it/s]
59.6%┣█████████████████████████▋                 ┫ 298/500 [00:24<00:16, 12it/s]
59.8%┣█████████████████████████▊                 ┫ 299/500 [00:24<00:16, 12it/s]
60.0%┣█████████████████████████▉                 ┫ 300/500 [00:24<00:16, 12it/s]
60.2%┣█████████████████████████▉                 ┫ 301/500 [00:24<00:16, 12it/s]
60.4%┣██████████████████████████                 ┫ 302/500 [00:24<00:16, 12it/s]
60.6%┣██████████████████████████                 ┫ 303/500 [00:24<00:16, 12it/s]
60.8%┣██████████████████████████▏                ┫ 304/500 [00:24<00:16, 12it/s]
61.0%┣██████████████████████████▎                ┫ 305/500 [00:25<00:16, 12it/s]
61.2%┣██████████████████████████▎                ┫ 306/500 [00:25<00:16, 12it/s]

61.4%┣██████████████████████████▍                ┫ 307/500 [00:25<00:16, 12it/s]
61.6%┣██████████████████████████▌                ┫ 308/500 [00:25<00:15, 12it/s]
61.8%┣██████████████████████████▋                ┫ 309/500 [00:25<00:15, 12it/s]
62.0%┣██████████████████████████▋                ┫ 310/500 [00:25<00:15, 12it/s]
62.2%┣██████████████████████████▊                ┫ 311/500 [00:25<00:15, 12it/s]
62.4%┣██████████████████████████▉                ┫ 312/500 [00:25<00:15, 12it/s]
62.6%┣███████████████████████████                ┫ 313/500 [00:25<00:15, 12it/s]
62.8%┣███████████████████████████                ┫ 314/500 [00:25<00:15, 12it/s]
63.0%┣███████████████████████████                ┫ 315/500 [00:25<00:15, 12it/s]
63.2%┣███████████████████████████▏               ┫ 316/500 [00:25<00:15, 12it/s]
63.4%┣███████████████████████████▎               ┫ 317/500 [00:25<00:15, 12it/s]
63.6%┣███████████████████████████▍               ┫ 318/500 [00:25<00:15, 12it/s]
63.8%┣███████████████████████████▍               ┫ 319/500 [00:25<00:15, 12it/s]
64.0%┣███████████████████████████▌               ┫ 320/500 [00:26<00:14, 12it/s]
64.2%┣███████████████████████████▋               ┫ 321/500 [00:26<00:14, 12it/s]
64.4%┣███████████████████████████▊               ┫ 322/500 [00:26<00:14, 12it/s]
64.6%┣███████████████████████████▉               ┫ 323/500 [00:26<00:14, 12it/s]
64.8%┣███████████████████████████▉               ┫ 324/500 [00:26<00:14, 12it/s]
65.0%┣████████████████████████████               ┫ 325/500 [00:26<00:14, 12it/s]
65.2%┣████████████████████████████               ┫ 326/500 [00:26<00:14, 13it/s]
65.4%┣████████████████████████████▏              ┫ 327/500 [00:26<00:14, 13it/s]
65.6%┣████████████████████████████▏              ┫ 328/500 [00:26<00:14, 13it/s]
65.8%┣████████████████████████████▎              ┫ 329/500 [00:26<00:14, 13it/s]
66.0%┣████████████████████████████▍              ┫ 330/500 [00:26<00:14, 13it/s]
66.2%┣████████████████████████████▌              ┫ 331/500 [00:26<00:13, 13it/s]
66.4%┣████████████████████████████▌              ┫ 332/500 [00:26<00:13, 13it/s]
66.6%┣████████████████████████████▋              ┫ 333/500 [00:26<00:13, 13it/s]
66.8%┣████████████████████████████▊              ┫ 334/500 [00:27<00:13, 13it/s]
67.0%┣████████████████████████████▉              ┫ 335/500 [00:27<00:13, 13it/s]
67.2%┣█████████████████████████████              ┫ 336/500 [00:27<00:13, 13it/s]
67.4%┣█████████████████████████████              ┫ 337/500 [00:27<00:13, 13it/s]
67.6%┣█████████████████████████████              ┫ 338/500 [00:27<00:13, 13it/s]
67.8%┣█████████████████████████████▏             ┫ 339/500 [00:27<00:13, 13it/s]
68.0%┣█████████████████████████████▎             ┫ 340/500 [00:27<00:13, 13it/s]
68.2%┣█████████████████████████████▎             ┫ 341/500 [00:27<00:13, 13it/s]
68.4%┣█████████████████████████████▍             ┫ 342/500 [00:27<00:13, 13it/s]
68.6%┣█████████████████████████████▌             ┫ 343/500 [00:27<00:12, 13it/s]
68.8%┣█████████████████████████████▋             ┫ 344/500 [00:27<00:12, 13it/s]
69.0%┣█████████████████████████████▊             ┫ 345/500 [00:27<00:12, 13it/s]
69.2%┣█████████████████████████████▊             ┫ 346/500 [00:27<00:12, 13it/s]
69.4%┣█████████████████████████████▉             ┫ 347/500 [00:27<00:12, 13it/s]
69.6%┣██████████████████████████████             ┫ 348/500 [00:27<00:12, 13it/s]
69.8%┣██████████████████████████████             ┫ 349/500 [00:28<00:12, 13it/s]
70.0%┣██████████████████████████████             ┫ 350/500 [00:28<00:12, 13it/s]
70.2%┣██████████████████████████████▏            ┫ 351/500 [00:28<00:12, 13it/s]
70.4%┣██████████████████████████████▎            ┫ 352/500 [00:28<00:12, 13it/s]
70.6%┣██████████████████████████████▍            ┫ 353/500 [00:28<00:12, 13it/s]
70.8%┣██████████████████████████████▍            ┫ 354/500 [00:28<00:12, 13it/s]
71.0%┣██████████████████████████████▌            ┫ 355/500 [00:28<00:11, 13it/s]
71.2%┣██████████████████████████████▋            ┫ 356/500 [00:28<00:11, 13it/s]
71.4%┣██████████████████████████████▊            ┫ 357/500 [00:28<00:11, 13it/s]
71.6%┣██████████████████████████████▉            ┫ 358/500 [00:28<00:11, 13it/s]
71.8%┣██████████████████████████████▉            ┫ 359/500 [00:28<00:11, 13it/s]
72.0%┣███████████████████████████████            ┫ 360/500 [00:28<00:11, 13it/s]
72.2%┣███████████████████████████████            ┫ 361/500 [00:28<00:11, 13it/s]
72.4%┣███████████████████████████████▏           ┫ 362/500 [00:28<00:11, 13it/s]
72.6%┣███████████████████████████████▏           ┫ 363/500 [00:29<00:11, 13it/s]
72.8%┣███████████████████████████████▎           ┫ 364/500 [00:29<00:11, 13it/s]
73.0%┣███████████████████████████████▍           ┫ 365/500 [00:29<00:11, 13it/s]
73.2%┣███████████████████████████████▌           ┫ 366/500 [00:29<00:11, 13it/s]
73.4%┣███████████████████████████████▋           ┫ 367/500 [00:29<00:10, 13it/s]
73.6%┣███████████████████████████████▋           ┫ 368/500 [00:29<00:10, 13it/s]
73.8%┣███████████████████████████████▊           ┫ 369/500 [00:29<00:10, 13it/s]
74.0%┣███████████████████████████████▉           ┫ 370/500 [00:29<00:10, 13it/s]
74.2%┣████████████████████████████████           ┫ 371/500 [00:29<00:10, 13it/s]
74.4%┣████████████████████████████████           ┫ 372/500 [00:29<00:10, 13it/s]
74.6%┣████████████████████████████████           ┫ 373/500 [00:29<00:10, 13it/s]
74.8%┣████████████████████████████████▏          ┫ 374/500 [00:29<00:10, 13it/s]
75.0%┣████████████████████████████████▎          ┫ 375/500 [00:29<00:10, 13it/s]
75.2%┣████████████████████████████████▍          ┫ 376/500 [00:29<00:10, 13it/s]
75.4%┣████████████████████████████████▍          ┫ 377/500 [00:30<00:10, 13it/s]
75.6%┣████████████████████████████████▌          ┫ 378/500 [00:30<00:10, 13it/s]
75.8%┣████████████████████████████████▋          ┫ 379/500 [00:30<00:09, 13it/s]
76.0%┣████████████████████████████████▊          ┫ 380/500 [00:30<00:09, 13it/s]
76.2%┣████████████████████████████████▊          ┫ 381/500 [00:30<00:09, 13it/s]
76.4%┣████████████████████████████████▉          ┫ 382/500 [00:30<00:09, 13it/s]
76.6%┣█████████████████████████████████          ┫ 383/500 [00:30<00:09, 13it/s]
76.8%┣█████████████████████████████████          ┫ 384/500 [00:30<00:09, 13it/s]
77.0%┣█████████████████████████████████          ┫ 385/500 [00:30<00:09, 13it/s]
77.2%┣█████████████████████████████████▏         ┫ 386/500 [00:30<00:09, 13it/s]
77.4%┣█████████████████████████████████▎         ┫ 387/500 [00:30<00:09, 13it/s]
77.6%┣█████████████████████████████████▍         ┫ 388/500 [00:30<00:09, 13it/s]
77.8%┣█████████████████████████████████▌         ┫ 389/500 [00:30<00:09, 13it/s]
78.0%┣█████████████████████████████████▌         ┫ 390/500 [00:30<00:09, 13it/s]
78.2%┣█████████████████████████████████▋         ┫ 391/500 [00:31<00:09, 13it/s]
78.4%┣█████████████████████████████████▊         ┫ 392/500 [00:31<00:08, 13it/s]
78.6%┣█████████████████████████████████▉         ┫ 393/500 [00:31<00:08, 13it/s]
78.8%┣█████████████████████████████████▉         ┫ 394/500 [00:31<00:08, 13it/s]
79.0%┣██████████████████████████████████         ┫ 395/500 [00:31<00:08, 13it/s]
79.2%┣██████████████████████████████████         ┫ 396/500 [00:31<00:08, 13it/s]
79.4%┣██████████████████████████████████▏        ┫ 397/500 [00:31<00:08, 13it/s]
79.6%┣██████████████████████████████████▎        ┫ 398/500 [00:31<00:08, 13it/s]
79.8%┣██████████████████████████████████▎        ┫ 399/500 [00:31<00:08, 13it/s]
80.0%┣██████████████████████████████████▍        ┫ 400/500 [00:31<00:08, 13it/s]
80.2%┣██████████████████████████████████▌        ┫ 401/500 [00:31<00:08, 13it/s]
80.4%┣██████████████████████████████████▋        ┫ 402/500 [00:31<00:08, 13it/s]
80.6%┣██████████████████████████████████▋        ┫ 403/500 [00:31<00:08, 13it/s]
80.8%┣██████████████████████████████████▊        ┫ 404/500 [00:31<00:07, 13it/s]
81.0%┣██████████████████████████████████▉        ┫ 405/500 [00:31<00:07, 13it/s]
81.2%┣███████████████████████████████████        ┫ 406/500 [00:32<00:07, 13it/s]
81.4%┣███████████████████████████████████        ┫ 407/500 [00:32<00:07, 13it/s]
81.6%┣███████████████████████████████████        ┫ 408/500 [00:32<00:07, 13it/s]

81.8%┣███████████████████████████████████▏       ┫ 409/500 [00:32<00:07, 13it/s]
82.0%┣███████████████████████████████████▎       ┫ 410/500 [00:32<00:07, 13it/s]
82.2%┣███████████████████████████████████▍       ┫ 411/500 [00:32<00:07, 13it/s]
82.4%┣███████████████████████████████████▍       ┫ 412/500 [00:32<00:07, 13it/s]
82.6%┣███████████████████████████████████▌       ┫ 413/500 [00:32<00:07, 13it/s]
82.8%┣███████████████████████████████████▋       ┫ 414/500 [00:32<00:07, 13it/s]
83.0%┣███████████████████████████████████▊       ┫ 415/500 [00:32<00:07, 13it/s]
83.2%┣███████████████████████████████████▊       ┫ 416/500 [00:32<00:07, 13it/s]
83.4%┣███████████████████████████████████▉       ┫ 417/500 [00:32<00:06, 13it/s]
83.6%┣████████████████████████████████████       ┫ 418/500 [00:32<00:06, 13it/s]
83.8%┣████████████████████████████████████       ┫ 419/500 [00:32<00:06, 13it/s]
84.0%┣████████████████████████████████████▏      ┫ 420/500 [00:33<00:06, 13it/s]
84.2%┣████████████████████████████████████▏      ┫ 421/500 [00:33<00:06, 13it/s]
84.4%┣████████████████████████████████████▎      ┫ 422/500 [00:33<00:06, 13it/s]
84.6%┣████████████████████████████████████▍      ┫ 423/500 [00:33<00:06, 13it/s]
84.8%┣████████████████████████████████████▌      ┫ 424/500 [00:33<00:06, 13it/s]
85.0%┣████████████████████████████████████▌      ┫ 425/500 [00:33<00:06, 13it/s]
85.2%┣████████████████████████████████████▋      ┫ 426/500 [00:33<00:06, 13it/s]
85.4%┣████████████████████████████████████▊      ┫ 427/500 [00:33<00:06, 13it/s]
85.6%┣████████████████████████████████████▉      ┫ 428/500 [00:33<00:06, 13it/s]
85.8%┣█████████████████████████████████████      ┫ 429/500 [00:33<00:06, 13it/s]
86.0%┣█████████████████████████████████████      ┫ 430/500 [00:33<00:05, 13it/s]
86.2%┣█████████████████████████████████████      ┫ 431/500 [00:33<00:05, 13it/s]
86.4%┣█████████████████████████████████████▏     ┫ 432/500 [00:33<00:05, 13it/s]
86.6%┣█████████████████████████████████████▎     ┫ 433/500 [00:33<00:05, 13it/s]
86.8%┣█████████████████████████████████████▎     ┫ 434/500 [00:34<00:05, 13it/s]
87.0%┣█████████████████████████████████████▍     ┫ 435/500 [00:34<00:05, 13it/s]
87.2%┣█████████████████████████████████████▌     ┫ 436/500 [00:34<00:05, 13it/s]
87.4%┣█████████████████████████████████████▋     ┫ 437/500 [00:34<00:05, 13it/s]
87.6%┣█████████████████████████████████████▊     ┫ 438/500 [00:34<00:05, 13it/s]
87.8%┣█████████████████████████████████████▊     ┫ 439/500 [00:34<00:05, 13it/s]
88.0%┣█████████████████████████████████████▉     ┫ 440/500 [00:34<00:05, 13it/s]
88.2%┣██████████████████████████████████████     ┫ 441/500 [00:34<00:05, 13it/s]
88.4%┣██████████████████████████████████████     ┫ 442/500 [00:34<00:04, 13it/s]
88.6%┣██████████████████████████████████████     ┫ 443/500 [00:34<00:04, 13it/s]
88.8%┣██████████████████████████████████████▏    ┫ 444/500 [00:34<00:04, 13it/s]
89.0%┣██████████████████████████████████████▎    ┫ 445/500 [00:34<00:04, 13it/s]
89.2%┣██████████████████████████████████████▍    ┫ 446/500 [00:34<00:04, 13it/s]
89.4%┣██████████████████████████████████████▍    ┫ 447/500 [00:34<00:04, 13it/s]
89.6%┣██████████████████████████████████████▌    ┫ 448/500 [00:34<00:04, 13it/s]
89.8%┣██████████████████████████████████████▋    ┫ 449/500 [00:35<00:04, 13it/s]
90.0%┣██████████████████████████████████████▊    ┫ 450/500 [00:35<00:04, 13it/s]
90.2%┣██████████████████████████████████████▉    ┫ 451/500 [00:35<00:04, 13it/s]
90.4%┣██████████████████████████████████████▉    ┫ 452/500 [00:35<00:04, 13it/s]
90.6%┣███████████████████████████████████████    ┫ 453/500 [00:35<00:04, 13it/s]
90.8%┣███████████████████████████████████████    ┫ 454/500 [00:35<00:04, 13it/s]
91.0%┣███████████████████████████████████████▏   ┫ 455/500 [00:35<00:03, 13it/s]
91.2%┣███████████████████████████████████████▏   ┫ 456/500 [00:35<00:03, 13it/s]
91.4%┣███████████████████████████████████████▎   ┫ 457/500 [00:35<00:03, 13it/s]
91.6%┣███████████████████████████████████████▍   ┫ 458/500 [00:35<00:03, 13it/s]
91.8%┣███████████████████████████████████████▌   ┫ 459/500 [00:35<00:03, 13it/s]
92.0%┣███████████████████████████████████████▋   ┫ 460/500 [00:35<00:03, 13it/s]
92.2%┣███████████████████████████████████████▋   ┫ 461/500 [00:35<00:03, 13it/s]
92.4%┣███████████████████████████████████████▊   ┫ 462/500 [00:35<00:03, 13it/s]
92.6%┣███████████████████████████████████████▉   ┫ 463/500 [00:36<00:03, 13it/s]
92.8%┣████████████████████████████████████████   ┫ 464/500 [00:36<00:03, 13it/s]
93.0%┣████████████████████████████████████████   ┫ 465/500 [00:36<00:03, 13it/s]
93.2%┣████████████████████████████████████████   ┫ 466/500 [00:36<00:03, 13it/s]
93.4%┣████████████████████████████████████████▏  ┫ 467/500 [00:36<00:03, 13it/s]
93.6%┣████████████████████████████████████████▎  ┫ 468/500 [00:36<00:02, 13it/s]
93.8%┣████████████████████████████████████████▍  ┫ 469/500 [00:36<00:02, 13it/s]
94.0%┣████████████████████████████████████████▍  ┫ 470/500 [00:36<00:02, 13it/s]
94.2%┣████████████████████████████████████████▌  ┫ 471/500 [00:36<00:02, 13it/s]
94.4%┣████████████████████████████████████████▋  ┫ 472/500 [00:36<00:02, 13it/s]
94.6%┣████████████████████████████████████████▊  ┫ 473/500 [00:36<00:02, 13it/s]
94.8%┣████████████████████████████████████████▊  ┫ 474/500 [00:36<00:02, 13it/s]
95.0%┣████████████████████████████████████████▉  ┫ 475/500 [00:36<00:02, 13it/s]
95.2%┣█████████████████████████████████████████  ┫ 476/500 [00:36<00:02, 13it/s]
95.4%┣█████████████████████████████████████████  ┫ 477/500 [00:37<00:02, 13it/s]
95.6%┣█████████████████████████████████████████  ┫ 478/500 [00:37<00:02, 13it/s]
95.8%┣█████████████████████████████████████████▏ ┫ 479/500 [00:37<00:02, 13it/s]
96.0%┣█████████████████████████████████████████▎ ┫ 480/500 [00:37<00:02, 13it/s]
96.2%┣█████████████████████████████████████████▍ ┫ 481/500 [00:37<00:01, 13it/s]
96.4%┣█████████████████████████████████████████▌ ┫ 482/500 [00:37<00:01, 13it/s]
96.6%┣█████████████████████████████████████████▌ ┫ 483/500 [00:37<00:01, 13it/s]
96.8%┣█████████████████████████████████████████▋ ┫ 484/500 [00:37<00:01, 13it/s]
97.0%┣█████████████████████████████████████████▊ ┫ 485/500 [00:37<00:01, 13it/s]
97.2%┣█████████████████████████████████████████▉ ┫ 486/500 [00:37<00:01, 13it/s]
97.4%┣█████████████████████████████████████████▉ ┫ 487/500 [00:37<00:01, 13it/s]
97.6%┣██████████████████████████████████████████ ┫ 488/500 [00:37<00:01, 13it/s]
97.8%┣██████████████████████████████████████████ ┫ 489/500 [00:37<00:01, 13it/s]
98.0%┣██████████████████████████████████████████▏┫ 490/500 [00:37<00:01, 13it/s]
98.2%┣██████████████████████████████████████████▎┫ 491/500 [00:37<00:01, 13it/s]
98.4%┣██████████████████████████████████████████▎┫ 492/500 [00:38<00:01, 13it/s]
98.6%┣██████████████████████████████████████████▍┫ 493/500 [00:38<00:01, 13it/s]
98.8%┣██████████████████████████████████████████▌┫ 494/500 [00:38<00:00, 13it/s]
99.0%┣██████████████████████████████████████████▋┫ 495/500 [00:38<00:00, 13it/s]
99.2%┣██████████████████████████████████████████▋┫ 496/500 [00:38<00:00, 13it/s]
99.4%┣██████████████████████████████████████████▊┫ 497/500 [00:38<00:00, 13it/s]
99.6%┣██████████████████████████████████████████▉┫ 498/500 [00:38<00:00, 13it/s]
99.8%┣███████████████████████████████████████████┫ 499/500 [00:38<00:00, 13it/s]
100.0%┣██████████████████████████████████████████┫ 500/500 [00:38<00:00, 13it/s]
100.0%┣██████████████████████████████████████████┫ 500/500 [00:38<00:00, 13it/s]

0

to_plot = Array(setup.O.w(sim_data[:,:,:,1,:]))[:,:,1,:]

#to_plot = setup_bar.O.w(pred_sim[:,:,1:2,:])[:,:,1,:]

​

​

ymin = minimum(to_plot)

ymax = maximum(to_plot)

​

​

anim = @animate for index in 1:size(to_plot)[3]

    Plots.heatmap(to_plot[:,:,index]',color = :brg,clim = (ymin,ymax),yflip=false,xtickfontsize = 10,ytickfontsize = 10

    ,aspect_ratio = :equal,titlefontsize=16,yguidefontsize=18,xguidefontsize=18,title = "Simplified ocean model",right_margin = 35Plots.mm)

    Plots.xlabel!(L"x")

    Plots.ylabel!(L"y")

    #title!(L"t = " * string(round(example_t[index],digits = 1)))

end

​

gif(anim, "DNS_flow.gif", fps = 30)

[ Info: Saved animation to /home/toby/Projects/LES_ML.jl/DNS_flow.gif

E = Array(fine_mesh.ip(sim_data,sim_data))[1:end]

E_bar = Array(coarse_mesh.ip(MP.FA_filter(sim_data[:,:,:,1,:]),MP.FA_filter(sim_data[:,:,:,1,:])))[1:end]

50-element Vector{Float64}:
 35.784832621818495
 35.46100956046554
 35.15520034212907
 34.8992535748291
 34.736348861409084
 34.50133146133429
 34.241157863832484
 34.075774881703225
 33.93142770058412
 33.73582792306607
 33.60422619421569
 33.4042943787034
 33.28822623852526
  ⋮
 30.094705723901505
 30.033827198131643
 29.970261185251953
 29.86543948405768
 29.785065494182795
 29.712550543426257
 29.633792420351377
 29.543746255050515
 29.474019644692902
 29.379218054470456
 29.304314213196385
 29.24099783387519

plot(E)

plot!(E_bar)

​

setup.O

LES_ML.operators_struct(Conv((3, 3), 2 => 1, bias=false), Conv((3, 3), 1 => 2, bias=false), LES_ML.var"#C#86"{Float64, Int64}(0.024543692606170175, Core.Box(Conv((3, 3), 2 => 4, bias=false)), Core.Box(Conv((3, 3), 2 => 4, bias=false)), 2, Core.Box(Conv((3, 3), 4 => 2, bias=false))), Conv((3, 3), 2 => 2, bias=false), Conv((3, 3), 2 => 1, bias=false))

